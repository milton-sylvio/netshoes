var StorageCart=function(){"use strict";var s={storage_name:"cart",profile:"#myProfile"},create=function(name,value){if("undefined"!=typeof Storage){console.log("Code for localStorage/sessionStorage OK!!!");var r=read(name);save(name,r===!1?value:update(name,r))}else console.log("Sorry! No Web Storage support..")},save=function(name,value){localStorage.setItem(name,value)},read=function(name){var sa=localStorage.getItem(name);return null!==sa&&void 0!==sa&&sa},update=function(name,value){var infos,c=value.split(","),cl=c.length,ads=storage_value.split("|"),local=ads[0];if(cl>1){for(var i=0;i<cl;i++)if(void 0!==c[i]&&(infos=c[i].split("|"),infos[0]===local))return value;return cl===s.qtde_locais&&c.shift(),c.push(storage_value),c}return infos=value.split("|"),infos[0]!==local?value+","+storage_value:value},erase=function(name,id_local){for(var c=read(name),v=c.split(","),i=0;i<v.length;i++)0===v[i].indexOf(id_local)&&v.splice(i,1);c.length>0?save(name,v):localStorage.removeItem(name)};return{create:create,read:read,save:save,update:update,erase:erase}}(),Cart=function(){"use strict";var s={class:{cart_bt_delete:".delete",cart_overlay_delete:".overlay-delete",bt_add_cart:".bt-add-cart",cart_list_produtcts:".cart-list-produtcts"},ids:{list_products:"listProdutos",total_items:"totalItems",total_amount:"totalAmount",total_installment:"totalInstallment"},data_attr:{data_product_id:"[data-product-id]"}},init=function(){listProducts(),actions()};window.onload=function(){var i,data_attr=document.querySelectorAll(s.class.bt_add_cart);for(i=0;i<data_attr.length;++i)data_attr[i].addEventListener("click",addCart)};var actions=function(){},listProducts=function(){readJson("/dist/js/data/products.json",function(err,data){if(null!=err)console.error("Algo deu errado: "+err);else{var key,id,title,price,installments,price_installments,currency_format,listing,products=data.products;products.sort(function(a,b){return a.id<b.id?-1:a.id>b.id?1:0});for(key in products)id=products[key].id,products[key].sku,title=products[key].title,products[key].description,products[key].availableSizes,products[key].style,price=formatCoin(products[key].price),installments=products[key].installments,products[key].currencyId,currency_format=products[key].currencyFormat,products[key].isFreeShipping,price_installments=products[key].price/installments,price_installments=parseFloat(price_installments.toFixed(2)),price_installments=formatCoin(price_installments),listing='<div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">',listing+='<div id="product_id_'+id+'" data-qtde="'+installments+'" class="products">',listing+='<div class="products-header">',listing+='<img src="https://placeholdit.imgix.net/~text?txtsize=33&txt=Curica&w=180&h=230" alt="'+title+'">',listing+="<span>"+title+"</span>",listing+="</div>",listing+='<div class="products-infos">',listing+='<span class="products-infos_price">'+currency_format+" "+price+"</span>",listing+='<span class="products-infos_installments">ou '+installments+"x "+currency_format+" "+price_installments+"</span>",listing+="</div>",listing+='<div class="products-add-cart">',listing+='<button class="bt bt-yellow bt-add-cart" data-product-id="'+id+'" data-toggle="sidebar-cart">Adicionar ao carrinho</button>',listing+="</div>",listing+="</div>",listing+="</div>",document.getElementById(s.ids.list_products).innerHTML+=listing;localStorage.setItem("products",JSON.stringify(products))}})},addCart=function(){var product_id=this.getAttribute("data-product-id"),products=JSON.parse(localStorage.getItem("products")),found=(products.length,products.id,function(id){return products.filter(function(data){return data.id==id})}(product_id));found.length>0?setTimeout(function(){setCart(found[0].id,parseInt(1),found[0].title,found[0].price,found[0].availableSizes,found[0].style)},2e3):alert("Oops! Algo errado aconteceu, por favor, tente novamente mais tarde...")},setCart=function(id,qty,title,price,size,style){var cart=null!=JSON.parse(localStorage.getItem("cart"))?JSON.parse(localStorage.getItem("cart")):{items:[]},current_prod=cart.items,found=function(id){return current_prod.filter(function(data){return data.id==id})}(id);if(found.length>0)console.log("current_prod.qty: "+found[0].qty,"qty: "+qty),found[0].qty=parseInt(found[0].qty+qty),console.log("found[0].qty: "+found[0].qty);else{var prod={id:id,qty:qty,title:title,price:price,size:size[0],style:style};cart.items.push(prod)}localStorage.setItem("cart",JSON.stringify(cart)),getCart(),SidebarCart.open();var j,bt_del=document.querySelectorAll(s.class.cart_bt_delete);for(j=0;j<bt_del.length;++j)bt_del[j].onmouseover=bntDeleteMouseAction,bt_del[j].onmouseout=bntDeleteMouseAction,bt_del[j].onclick=deleteItemCart},getCart=function(){var cart=null!=JSON.parse(localStorage.getItem("cart"))?JSON.parse(localStorage.getItem("cart")):{items:[]},wrapper=document.querySelector(s.class.cart_list_produtcts),total=0;if(wrapper.innerHTML="",void 0==cart||null==cart||""==cart||0==cart.items.length){var cart_empty=document.getElementById("msgCart");cart_empty.innerHTML="Seu carrinho está vazio",cart_empty.classList.toggle("hide")}else{var n,item="",c_i=cart.items;for(n=0;n<c_i.length;n++)total+=c_i[n].qty*c_i[n].price,item+='<div class="produtcts-row">',item+='<a role="button" class="delete" data-id="'+c_i[n].id+'" title="Deseja remover este produto do carrinho?">&times;</a>',item+='<div class="produtcts-grid">',item+='<div class="cart-list-produtcts_img"><img src="https://placeholdit.imgix.net/~text?txtsize=55x55&txt=Curica&w=50&h=50"></div>',item+='<div class="cart-list-produtcts_infos">',item+='<h4 class="product-title">'+c_i[n].title+"</h4>",item+='<div class="cart-list-produtcts_infos_details">',item+='<span class="product-size">'+c_i[n].size+"</span>",item+='<span class="product-color">'+c_i[n].style+"</span>",item+='<span class="product-amount">Quantidade: '+c_i[n].qty+"</span>",item+="</div>",item+='<div class="cart-list-produtcts_infos_price">',item+='<span class="product-price">'+formatCoin(c_i[n].price)+"</span>",item+='</div></div></div><div class="overlay-delete"></div></div><!-- /.produtcts-row -->',console.log("total:",total);wrapper.classList.toggle("hide"),wrapper.innerHTML=item;var installment=total/10;installment=parseFloat(installment.toFixed(2)),installment=formatCoin(installment),document.getElementById(s.ids.total_installment).innerHTML="ou em até 10x de R$ "+installment,total=parseFloat(total.toFixed(2)),total=formatCoin(total),document.getElementById(s.ids.total_amount).innerHTML=" R$ "+total,document.getElementById(s.ids.total_items).innerHTML=cart.items.length}},deleteItemCart=function(){if(console.log("Entrou"),confirm("Deseja excluir esse produto?")){var cart=null!=JSON.parse(localStorage.getItem("cart"))?JSON.parse(localStorage.getItem("cart")):{items:[]},id=this.getAttribute("data-id"),cart_items=cart.items;(function(id){return cart_items.filter(function(data){return data.id==id})})(id).length>0&&(function(property,num,arr){for(var i in arr)arr[i][property]==num&&arr.splice(i,1)}("id",id,cart_items),this.parentElement.remove()),localStorage.setItem("cart",JSON.stringify(cart))}},readJson=function(url,callback){var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="json",xhr.onload=function(){var status=xhr.status;200==status?callback(null,xhr.response):callback(status)},xhr.send()},bntDeleteMouseAction=function(e){var parent=this.parentElement,class_list=parent.classList,overlay=this.parentElement.querySelector(s.class.cart_overlay_delete);"mouseover"==e.type?(overlay.style.display="block",class_list.add("strikethrough")):(class_list.remove("strikethrough"),overlay.style.display="none")},formatCoin=function(valor){var inteiro=null,decimal=null,c=null,j=null,aux=new Array;for(valor=""+valor,c=valor.indexOf(".",0),c>0?(inteiro=valor.substring(0,c),decimal=valor.substring(c+1,valor.length),1===decimal.length&&(decimal+="0")):inteiro=valor,j=inteiro.length,c=0;j>0;j-=3,c++)aux[c]=inteiro.substring(j-3,j);for(inteiro="",c=aux.length-1;c>=0;c--)inteiro+=aux[c]+".";return inteiro=inteiro.substring(0,inteiro.length-1),decimal=parseInt(decimal),isNaN(decimal)?decimal="00":(decimal=""+decimal,1===decimal.length&&(decimal="0"+decimal)),valor="<strong>"+inteiro+"</strong>,"+decimal};return{init:init}}();Cart.init();var SidebarCart=function(){"use strict";var s={activator:'[data-toggle="sidebar-cart"]',sidebar:".sidebar-cart",sidebar_cart_side:"sidebar-left",sidebar_cart_backdrop:".sidebar-cart-backdrop",bt_fechar_sidebar_cart:".sidebar-cart-close"},elem=document.querySelector(s.sidebar),is_open=!1,backdrop=document.querySelector(s.sidebar_cart_backdrop),close=function(){elem.classList.contains("active")&&(window.setTimeout(function(){elem.style.right="-100%",elem.style.display="none"},350),window.setTimeout(function(){is_open=!1,backdrop.classList.remove("in")},700))};return{init:function(){document.querySelector(s.sidebar_cart_backdrop).onclick=close},s:s,open:function(){console.info("Entrou no open"),elem.classList.contains("active")&&elem.classList.remove("active"),elem.classList.add("active"),window.setTimeout(function(){elem.style.display="block",elem.style.right=0},700),window.setTimeout(function(){is_open=!0,backdrop.classList.add("in")},350)}}}();SidebarCart.init();